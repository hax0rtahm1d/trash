<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OCR Server</title>
    <script src="./ocrad.min.js"></script>
</head>
<body>
    <h1>OCR Server</h1>

    <!-- Display Image -->
    <div id="image-container">
        <h2>Image Display:</h2>
        <img id="image" style="max-width: 100%; height: auto;" />
    </div>

    <h2>OCR Result:</h2>
    <pre id="ocr-result"></pre>

    <script>
        // Function to extract the base64 image from the query parameter and show it
        async function handleOCRRequest() {
            const urlParams = new URLSearchParams(window.location.search);
            const base64Image = urlParams.get('base64Image'); // Get the base64Image parameter from the URL

            if (!base64Image) {
                console.error("No image provided.");
                return;
            }

            // Set the image source to the base64 data
            const imgElement = document.getElementById("image");
            imgElement.src = base64Image;

            // Wait for the image to load
            await new Promise((resolve, reject) => {
                imgElement.onload = resolve;
                imgElement.onerror = reject;
            });

            // Create a canvas and draw the image
            const canvas = document.createElement('canvas');
            canvas.width = imgElement.width;
            canvas.height = imgElement.height;
            const ctx = canvas.getContext('2d');
            ctx.drawImage(imgElement, 0, 0);

            // Perform OCR
            const result = Ocrad(canvas);

            // Show the OCR result
            const resultElement = document.getElementById("ocr-result");
            resultElement.textContent = result;

            // Log OCR result in the console
            console.log("OCR Result:", result);
        }

        // Call the function to handle the OCR
        handleOCRRequest();
    </script>
</body>
</html>
